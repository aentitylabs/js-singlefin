{"version":3,"file":"singlefin.js","mappings":"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","sources":["webpack://jssinglefin/webpack/universalModuleDefinition","webpack://jssinglefin/../node_modules/js-entity-store/dist/entitystore.js","webpack://jssinglefin/C:\\work\\aentity\\workspace\\js-singlefin\\src\\influencer\\follower.ts","webpack://jssinglefin/C:\\work\\aentity\\workspace\\js-singlefin\\src\\influencer\\influencer.ts","webpack://jssinglefin/C:\\work\\aentity\\workspace\\js-singlefin\\src\\influencer\\nullstate.ts","webpack://jssinglefin/C:\\work\\aentity\\workspace\\js-singlefin\\src\\influencer\\state.ts","webpack://jssinglefin/C:\\work\\aentity\\workspace\\js-singlefin\\src\\singlefin.ts","webpack://jssinglefin/C:\\work\\aentity\\workspace\\js-singlefin\\src\\singlefinsource.ts","webpack://jssinglefin/webpack/bootstrap","webpack://jssinglefin/C:\\work\\aentity\\workspace\\js-singlefin\\src\\main.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"jssinglefin\"] = factory();\n\telse\n\t\troot[\"jssinglefin\"] = factory();\n})(this, function() {\nreturn ","!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define([],t):\"object\"==typeof exports?exports.jsentitystore=t():e.jsentitystore=t()}(this,(function(){return(()=>{\"use strict\";var e={534:(e,t)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.Bridge=void 0,t.Bridge=class{}},665:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.DeleteSourceAction=void 0;const r=i(608),s=i(58);class o extends s.SourceAction{constructor(e){super(\"DeleteSourceAction\",e)}sync(e){const t=this.entity.serialize(),i=r.EntityFactory.buildEntityDataFromSchema(t);this.validateDelete(i),e.delete(i)}}t.DeleteSourceAction=o},753:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.Entity=void 0;const r=i(608),s=i(92),o=i(190);t.Entity=class{constructor(e,t,i,s){let n;this._properties={},this._isReferenced=!1,this._source=new o.NullSource,this._isItem=!1,this._isCollection=!1,this._item={},this._entityStore=e,this._name=t,this._key=t,this._item=s,this._isCollection=!!s,null!=i&&null!=i&&(this._key=i.getKey()+\"=>\"+this._key,this._isReferenced=!0,n=i._source),this._ref=i,this._entityStore.register(this,n),i||(this._ref=this,this._entityStore.load(this)),this._item&&(this._itemPrototype=r.EntityFactory.newEntity(this._entityStore,this._item,this))}setKey(e){this._key=e}getKey(){return this._key}setName(e){this._name=e}getName(){return this._name}getRef(){return this._ref}getProperties(){return this._properties}getSource(){return this._source}getEntityStore(){return this._entityStore}setSource(e){this._source=e}isReferenced(){return this._isReferenced}isCollection(){return this._isCollection}setIsItem(e){this._isItem=e}isItem(){return this._isItem}getItem(){return this._item}getItemPrototype(){return this._itemPrototype}delete(){this._entityStore.delete(this)}get(e){return this._properties[e].value}add(){const e=r.EntityFactory.newEntity(this._entityStore,this._item,this);e.deserialize(this.getItem());const t=Object.keys(this.getProperties()).length;return this.getProperties()[t]=e,e.setKey(e.getKey()+\"[\"+t+\"]\"),e.setIsItem(!0),this.getEntityStore().register(e,this.getSource()),this.getEntityStore().update(e),this.getEntityStore().load(this),e}remove(e){const t=this.get(e);this.getEntityStore().delete(t),this.getEntityStore().load(this)}serialize(){const e={};for(var t in e.entity=this.getName(),e.properties={},e.ref=this.isReferenced(),this.getProperties())e.properties[t]=this.getProperties()[t].serialize();return e}deserialize(e){if(this.setName(e.entity),!e.properties)return;let t=0;for(let i in e.properties){const r=new s.EntityProperty(this.getEntityStore(),this);if(r.deserialize(e.properties[i]),this.getProperties()[i]=r,this.isCollection()){const e=r.value;e.setKey(e.getKey()+\"[\"+t+\"]\"),e.setIsItem(!0),this.getEntityStore().register(e,this.getSource())}t++}}}},608:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.EntityFactory=void 0;const r=i(753),s=i(557);class o{static newEntity(e,t,i){let o=null;return o=t.collectionItem?new r.Entity(e,t.entity,i,t.collectionItem):new r.Entity(e,t.entity,i),o.deserialize(t),new Proxy(o,new s.EntityHandler)}static buildEntitySchemaFromData(e,t){const i={};i.entity=e.getName(),i.properties={},i.ref=e.isReferenced();for(let r in t)!0===e.isCollection()?(i.collectionItem=e.getItem(),e.getItemPrototype()&&(i.properties[r]=o.buildEntitySchemaFromData(e.getItemPrototype(),t[r]))):!0===e.getProperties()[r].isEntity?i.properties[r]=o.buildEntitySchemaFromData(e.getProperties()[r].value,t[r]):i.properties[r]={value:t[r]};return i}static buildEntityDataFromSchema(e){const t={};for(let i in e.properties)e.properties[i].entity?t[i]=o.buildEntityDataFromSchema(e.properties[i]):t[i]=e.properties[i].value;return t}}t.EntityFactory=o},557:(e,t)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.EntityHandler=void 0,t.EntityHandler=class{get(e,t,i){return e.getProperties()[t]?e.getProperties()[t].value:e[t]}set(e,t,i){return e.getProperties()[t]?(e.getProperties()[t].value=i,e.getEntityStore().update(e),!0):(e[t]=i,!0)}}},92:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.EntityProperty=void 0;const r=i(608);t.EntityProperty=class{constructor(e,t){this._isEntity=!1,this._entityStore=e,this._ref=t}get isEntity(){return this._isEntity}get value(){return this._value}set value(e){this._value=e}serialize(){return!0===this._isEntity?this._value.serialize():{value:this._value}}deserialize(e){if(e.entity){const t=!0===e.ref?this._ref:void 0;return this._value=r.EntityFactory.newEntity(this._entityStore,e,t),this._isEntity=!0,void this._value.deserialize(e)}this._value=e.value}}},758:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.EntityStore=void 0;const r=i(665),s=i(608),o=i(328),n=i(190),c=i(172),u=i(246);t.EntityStore=class{constructor(){this._sources={},this._entities={},this._actions={}}get actions(){return this._actions}addSource(e,t){this._sources[e]=t}register(e,t){this._entities[e.getKey()]=e,t?e.setSource(t):this._sources[e.getName()]?e.setSource(this._sources[e.getName()]):e.setSource(new n.NullSource)}sync(){for(;Object.keys(this._actions).length>0;){const e=Object.keys(this._actions)[0],t=this._actions[e];t.sync(t.entity.getSource()),delete this._actions[e]}}syncTo(e){return new Promise(((t,i)=>{const r={};for(const e in this._actions){const t=this._actions[e];t.sync(t.entity.getSource()),r[e]=c.SourceActionFactory.serialize(t)}e.send(r,(e=>{for(;Object.keys(this._actions).length>0;){const t=Object.keys(this._actions)[0],i=this._actions[t],r=i.entity.getName();e[r]&&(i.entity.deserialize(e[r]),this._sources[r]&&i.sync(this._sources[r])),delete this._actions[t]}t()}))}))}syncFrom(e,t,i){const r={},o={};for(const e in t){const i=t[e];this._entities[i.entityKey]||(this._entities[i.entityKey]=s.EntityFactory.newEntity(this,i.entity,this._entities[i.refKey]));const n=this._entities[i.entityKey];n.deserialize(i.entity),r[e]=c.SourceActionFactory.deserialize(i,n);const u=r[e].entity.getName();this._sources[u]&&(r[e].sync(this._sources[u]),o[u]=r[e].entity)}i(),this.sync();const n={};for(const e in o)n[e]=o[e].serialize();e.reply(n)}load(e){if(e.isReferenced()&&!e.isItem()&&e.getRef())return this.load(e.getRef());this._actions[e.getKey()+\"::load\"]=new o.LoadSourceAction(e)}update(e){if(e.isReferenced()&&!e.isItem()&&e.getRef())return this.update(e.getRef());this._actions[e.getKey()+\"::update\"]=new u.UpdateSourceAction(e)}delete(e){if(e.isReferenced()&&!e.isItem()&&e.getRef())return this.delete(e.getRef());this._actions[e.getKey()+\"::delete\"]=new r.DeleteSourceAction(e)}}},328:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.LoadSourceAction=void 0;const r=i(608),s=i(58);class o extends s.SourceAction{constructor(e){super(\"LoadSourceAction\",e)}sync(e){const t=this.entity.serialize(),i=r.EntityFactory.buildEntityDataFromSchema(t),s=e.load(i);this.validateLoad(s);const o=r.EntityFactory.buildEntitySchemaFromData(this.entity,s);this.entity.deserialize(o)}}t.LoadSourceAction=o},190:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.NullSource=void 0;const r=i(886);class s extends r.Source{load(e){return e}update(e){return e}delete(e){}}t.NullSource=s},625:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.NullSourceAction=void 0;const r=i(58);class s extends r.SourceAction{constructor(e){super(\"NullSourceAction\",e)}sync(e){throw new Error(\"NullSourceAction: method not implemented.\")}}t.NullSourceAction=s},886:(e,t)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.Source=void 0,t.Source=class{}},58:(e,t)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.SourceAction=void 0,t.SourceAction=class{constructor(e,t){this._type=e,this._entity=t}get type(){return this._type}get entity(){return this._entity}set entity(e){this._entity=e}validateLoad(e){}validateUpdate(e){}validateDelete(e){}}},172:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.SourceActionFactory=void 0;const r=i(665),s=i(328),o=i(625),n=i(246);t.SourceActionFactory=class{static serialize(e){const t={};return t.type=e.type,t.entityKey=e.entity.getKey(),t.entityType=e.entity.getName(),t.entity=e.entity.serialize(),t.refKey=e.entity.getRef()?e.entity.getRef().getKey():void 0,t}static deserialize(e,t){switch(e.type){case\"LoadSourceAction\":return new s.LoadSourceAction(t);case\"UpdateSourceAction\":return new n.UpdateSourceAction(t);case\"DeleteSourceAction\":return new r.DeleteSourceAction(t)}return new o.NullSourceAction(t)}}},246:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.UpdateSourceAction=void 0;const r=i(608),s=i(58);class o extends s.SourceAction{constructor(e){super(\"UpdateSourceAction\",e)}sync(e){const t=this.entity.serialize(),i=r.EntityFactory.buildEntityDataFromSchema(t);this.validateUpdate(i);const s=e.update(i),o=r.EntityFactory.buildEntitySchemaFromData(this.entity,s);this.entity.deserialize(o)}}t.UpdateSourceAction=o}},t={};function i(r){var s=t[r];if(void 0!==s)return s.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,i),o.exports}var r={};return(()=>{var e=r;Object.defineProperty(e,\"__esModule\",{value:!0}),e.Bridge=e.Source=e.EntityFactory=e.EntityStore=void 0;const t=i(758);Object.defineProperty(e,\"EntityStore\",{enumerable:!0,get:function(){return t.EntityStore}});const s=i(608);Object.defineProperty(e,\"EntityFactory\",{enumerable:!0,get:function(){return s.EntityFactory}});const o=i(886);Object.defineProperty(e,\"Source\",{enumerable:!0,get:function(){return o.Source}});const n=i(534);Object.defineProperty(e,\"Bridge\",{enumerable:!0,get:function(){return n.Bridge}})})(),r})()}));\r\n//# sourceMappingURL=entitystore.js.map","import { Influencer } from \"./influencer\";\r\nimport { NullState } from \"./nullstate\";\r\nimport { State } from \"./state\";\r\n\r\nexport class Follower {\r\n    private _name: string;\r\n    private _state: State = new NullState();\r\n    private _influencers: Influencer[] = [];\r\n    private _states: any = {};\r\n    private _trendStates: any = {};\r\n\r\n\r\n    public constructor(name: string) {\r\n        this._name = name;\r\n\r\n        this._state.follower = this;\r\n    }\r\n\r\n    public get name() {\r\n        return this._name;\r\n    }\r\n    \r\n    public addInfluencer(influencer: Influencer) {\r\n        this._influencers.push(influencer);\r\n    }\r\n\r\n    public addState(stateName: string, state: State) {\r\n        state.name = stateName;\r\n        state.follower = this;\r\n\r\n        this._states[stateName] = state;\r\n    }\r\n\r\n    public subscribe(influencer: Influencer) {\r\n        this.addInfluencer(influencer);\r\n\r\n        influencer.subscribe(this);\r\n    }\r\n\r\n    public follow(trend: string) {\r\n        this._influencers.forEach((influencer: Influencer) => {\r\n            influencer.follow(trend, this._name);\r\n        });\r\n    }\r\n\r\n    public on(trend: string, state: string) {\r\n        this._trendStates[trend] = this._states[state];\r\n    }\r\n\r\n    public changeState(state: string) {\r\n        this._state = this._states[state];\r\n    }\r\n\r\n    public handle(trend: string, model: any): void {\r\n        this._state.handle(trend, model);\r\n    }\r\n\r\n    public onTrendChange(trend: string, model: any): void {\r\n        if(this._trendStates[trend]) {\r\n            this._state = this._trendStates[trend];\r\n        }\r\n        \r\n        this.handle(trend, model);\r\n    }\r\n\r\n    public set state(state: State) {\r\n        this._state = state;\r\n    }\r\n\r\n    public serialize(): any {\r\n        return {\r\n            name: this._name,\r\n            state: this._state.name\r\n        }\r\n    }\r\n\r\n    public deserialize(follower: any) {\r\n        this._name = follower.name;\r\n        this._state = this._states[follower.state];\r\n    }\r\n}","import { Follower } from \"./follower\";\r\n\r\nexport class Influencer {\r\n    protected _followers: any = {};\r\n    protected _trends: any = {};\r\n\r\n\r\n    public subscribe(follower: Follower){\r\n        this._followers[follower.name] = follower;\r\n    }\r\n\r\n    public init(trends: any) {\r\n        for(const key in trends) {\r\n            const followers = trends[key];\r\n\r\n            for(let i=0; i<followers.length; i++) {\r\n                if(this._followers[followers[i].name]) {\r\n                    const follower = this._followers[followers[i].name];\r\n\r\n                    follower.deserialize(followers[i]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    public follow(trend: string, follower: string) {\r\n        if(!this._trends[trend]) {\r\n            this._trends[trend] = [];\r\n        }\r\n        \r\n        this._trends[trend].push(this._followers[follower]);\r\n    }\r\n\r\n    public newTrend(trend: string, model: any) {\r\n        const followers = this._trends[trend];\r\n\r\n        if(!followers) {\r\n            return;\r\n        }\r\n\r\n        for(let i=0; i<followers.length; i++) {\r\n            followers[i].onTrendChange(trend, model);\r\n        }\r\n    }\r\n\r\n    public serialize(): any {\r\n        const influencer: any = {\r\n            followers: {}\r\n        };\r\n\r\n        for(const key in this._followers) {\r\n            const follower = this._followers[key];\r\n            \r\n            influencer.followers[key] = follower.serialize();\r\n        }\r\n\r\n        return influencer;\r\n    }\r\n}","import { State } from \"./state\";\r\n\r\nexport class NullState extends State {\r\n    public handle(trend: string, model: any): void {\r\n        \r\n    }\r\n}","import { Follower } from \"./follower\";\r\n\r\nexport abstract class State {\r\n    private _name: string = \"\";\r\n    private _follower: Follower | undefined;\r\n\r\n\r\n    public set name(name: string) {\r\n        this._name = name;\r\n    }\r\n\r\n    public get name() {\r\n        return this._name;\r\n    }\r\n\r\n    public set follower(follower: Follower) {\r\n        this._follower = follower;\r\n    }\r\n\r\n    public changeState(state: string) {\r\n        if(this._follower) {\r\n            this._follower.changeState(state);\r\n        }\r\n    }\r\n\r\n    public abstract handle(trend: string, model: any): void;\r\n}","import { Influencer } from \"./influencer/influencer\";\r\nimport { EntityStore } from \"js-entity-store\"\r\nimport { EntityFactory } from \"js-entity-store\";\r\nimport { Source } from \"js-entity-store\";\r\nimport { Bridge } from \"js-entity-store\";\r\nimport { SinglefinSource } from \"./singlefinsource\";\r\nimport { ModelLoader } from \"./modelloader\";\r\n\r\n\r\nexport class Singlefin extends Influencer {\r\n    private _entityStore: EntityStore = new EntityStore();\r\n    private _model: any;\r\n    private _currentTrend: any;\r\n\r\n    public constructor() {\r\n        super();\r\n\r\n        this._currentTrend = EntityFactory.newEntity(this._entityStore, {\r\n            \"entity\": \"Singlefin\",\r\n            \"ref\": false,\r\n            \"properties\": {\r\n                \"trend\": {\r\n                    \"value\": \"\"\r\n                },\r\n                \"trends\": {\r\n                    \"value\": {}\r\n                }\r\n            }\r\n        });\r\n\r\n        this._entityStore.addSource(\"Singlefin\", new SinglefinSource());\r\n    }\r\n\r\n    public loadModel(modelLoader: ModelLoader) {\r\n        return new Promise<void>((resolve, reject) => {\r\n            modelLoader.load((model: any) => {\r\n                this._model = EntityFactory.newEntity(this._entityStore, model);\r\n\r\n                resolve();\r\n            });\r\n        });\r\n    }\r\n\r\n    public setModel(model: any) {\r\n        this._model = EntityFactory.newEntity(this._entityStore, model);\r\n    }\r\n\r\n    public get model(): any {\r\n        return this._model;\r\n    }\r\n\r\n    public addSource(entityName: string, source: Source) {\r\n        this._entityStore.addSource(entityName, source);\r\n    }\r\n\r\n    public inform(trend: string) {\r\n        const followers = this._trends[trend];\r\n\r\n        this._currentTrend.trend = trend;\r\n        this._currentTrend.trends[trend] = this.serializeFollowers(followers);\r\n\r\n        this._entityStore.sync();\r\n\r\n        this.newTrend(trend, this._model);\r\n\r\n        this._entityStore.sync();\r\n    }\r\n\r\n    public informTo(bridge: Bridge, trend: string) {\r\n        const followers = this._trends[trend];\r\n\r\n        this._currentTrend.trend = trend;\r\n        this._currentTrend.trends[trend] = this.serializeFollowers(followers);\r\n\r\n        return this._entityStore.syncTo(bridge).then(() => {\r\n            this.init(this._currentTrend.trends);\r\n\r\n            this.newTrend(this._currentTrend.trend, this._model);\r\n\r\n            return this._entityStore.syncTo(bridge);\r\n        });\r\n    }\r\n\r\n    public informFrom(bridge: Bridge, actions: any) {\r\n        this._entityStore.syncFrom(bridge, actions, () => {\r\n            this.init(this._currentTrend.trends);\r\n\r\n            this.newTrend(this._currentTrend.trend, this._model);\r\n\r\n            const followers = this._trends[this._currentTrend.trend];\r\n\r\n            this._currentTrend.trends[this._currentTrend.trend] = this.serializeFollowers(followers);\r\n        });\r\n    }\r\n\r\n    private serializeFollowers(followers: any[]) {\r\n        const serializedFollowers = [];\r\n\r\n        for(let i=0; i<followers.length; i++) {\r\n            serializedFollowers.push(followers[i].serialize());\r\n        }\r\n\r\n        return serializedFollowers;\r\n    }\r\n}\r\n","import { Source } from \"js-entity-store\";\r\n\r\nexport class SinglefinSource extends Source {\r\n    public load(entity: any) {\r\n        return entity;\r\n    }\r\n    public update(entity: any) {\r\n        return entity;\r\n    }\r\n    public delete(entity: any): void {\r\n    }\r\n    \r\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import { Singlefin } from \"./singlefin\";\r\nimport { Follower } from \"./influencer/follower\";\r\nimport { ModelLoader } from \"./modelloader\";\r\nimport { State } from \"./influencer/state\";\r\n\r\nexport { Singlefin, Follower, ModelLoader, State }"],"names":["root","factory","exports","module","define","amd","this","e","t","Object","defineProperty","value","Bridge","i","DeleteSourceAction","r","s","o","SourceAction","constructor","super","sync","entity","serialize","EntityFactory","buildEntityDataFromSchema","validateDelete","delete","Entity","n","_properties","_isReferenced","_source","NullSource","_isItem","_isCollection","_item","_entityStore","_name","_key","getKey","_ref","register","load","_itemPrototype","newEntity","setKey","setName","getName","getRef","getProperties","getSource","getEntityStore","setSource","isReferenced","isCollection","setIsItem","isItem","getItem","getItemPrototype","get","add","deserialize","keys","length","update","remove","properties","ref","EntityProperty","static","collectionItem","Proxy","EntityHandler","buildEntitySchemaFromData","isEntity","set","_isEntity","_value","EntityStore","c","u","_sources","_entities","_actions","actions","addSource","syncTo","Promise","SourceActionFactory","send","syncFrom","entityKey","refKey","reply","LoadSourceAction","UpdateSourceAction","validateLoad","Source","NullSourceAction","Error","_type","_entity","type","validateUpdate","entityType","enumerable","name","_state","NullState","_influencers","_states","_trendStates","follower","addInfluencer","influencer","push","addState","stateName","state","subscribe","follow","trend","forEach","on","changeState","handle","model","onTrendChange","_followers","_trends","init","trends","key","followers","newTrend","State","_follower","Singlefin","Influencer","_currentTrend","SinglefinSource","loadModel","modelLoader","resolve","reject","_model","setModel","entityName","source","inform","serializeFollowers","informTo","bridge","then","informFrom","serializedFollowers","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","call","Follower"],"sourceRoot":""}