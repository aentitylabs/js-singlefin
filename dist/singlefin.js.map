{"version":3,"file":"singlefin.js","mappings":"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","sources":["webpack://jssinglefin/webpack/universalModuleDefinition","webpack://jssinglefin/../node_modules/js-entity-store/dist/entitystore.js","webpack://jssinglefin/./home/eagudio/work/aentity/workspace/js-singlefin/src/influencer/follower.ts","webpack://jssinglefin/./home/eagudio/work/aentity/workspace/js-singlefin/src/influencer/influencer.ts","webpack://jssinglefin/./home/eagudio/work/aentity/workspace/js-singlefin/src/influencer/nullstate.ts","webpack://jssinglefin/./home/eagudio/work/aentity/workspace/js-singlefin/src/influencer/state.ts","webpack://jssinglefin/./home/eagudio/work/aentity/workspace/js-singlefin/src/singlefin.ts","webpack://jssinglefin/./home/eagudio/work/aentity/workspace/js-singlefin/src/singlefinsource.ts","webpack://jssinglefin/webpack/bootstrap","webpack://jssinglefin/./home/eagudio/work/aentity/workspace/js-singlefin/src/main.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"jssinglefin\"] = factory();\n\telse\n\t\troot[\"jssinglefin\"] = factory();\n})(this, function() {\nreturn ","!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define([],t):\"object\"==typeof exports?exports.jsentitystore=t():e.jsentitystore=t()}(this,(function(){return(()=>{\"use strict\";var e={534:(e,t)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.Bridge=void 0,t.Bridge=class{}},665:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.DeleteSourceAction=void 0;const r=i(608),s=i(58);class o extends s.SourceAction{constructor(e){super(\"DeleteSourceAction\",e)}sync(e){const t=this.entity.serialize(),i=r.EntityFactory.buildEntityDataFromSchema(t);this.validateDelete(i),e.delete(i)}}t.DeleteSourceAction=o},753:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.Entity=void 0;const r=i(608),s=i(92),o=i(190);t.Entity=class{constructor(e,t,i,s){let n;this._properties={},this._isReferenced=!1,this._source=new o.NullSource,this._isItem=!1,this._isCollection=!1,this._item={},this._entityStore=e,this._name=t,this._key=t,this._item=s,this._isCollection=!!s,null!=i&&null!=i&&(this._key=i.getKey()+\"=>\"+this._key,this._isReferenced=!0,n=i._source),this._ref=i,this._entityStore.register(this,n),i||(this._ref=this,this._entityStore.load(this)),this._item&&(this._itemPrototype=r.EntityFactory.newEntity(this._entityStore,this._item,this))}setKey(e){this._key=e}getKey(){return this._key}setName(e){this._name=e}getName(){return this._name}getRef(){return this._ref}getProperties(){return this._properties}getSource(){return this._source}getEntityStore(){return this._entityStore}setSource(e){this._source=e}isReferenced(){return this._isReferenced}isCollection(){return this._isCollection}setIsItem(e){this._isItem=e}isItem(){return this._isItem}getItem(){return this._item}getItemPrototype(){return this._itemPrototype}delete(){this._entityStore.delete(this)}get(e){return this._properties[e].value}add(){const e=r.EntityFactory.newEntity(this._entityStore,this._item,this);e.deserialize(this.getItem());const t=Object.keys(this.getProperties()).length;return this.getProperties()[t]=e,e.setKey(e.getKey()+\"[\"+t+\"]\"),e.setIsItem(!0),this.getEntityStore().register(e,this.getSource()),this.getEntityStore().update(e),this.getEntityStore().load(this),e}remove(e){const t=this.get(e);this.getEntityStore().delete(t),this.getEntityStore().load(this)}serialize(){const e={};for(var t in e.entity=this.getName(),e.properties={},e.ref=this.isReferenced(),this.getProperties())e.properties[t]=this.getProperties()[t].serialize();return e}deserialize(e){if(this.setName(e.entity),!e.properties)return;let t=0;for(let i in e.properties){const r=new s.EntityProperty(this.getEntityStore(),this);if(r.deserialize(e.properties[i]),this.getProperties()[i]=r,this.isCollection()){const e=r.value;e.setKey(e.getKey()+\"[\"+t+\"]\"),e.setIsItem(!0),this.getEntityStore().register(e,this.getSource())}t++}}}},608:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.EntityFactory=void 0;const r=i(753),s=i(557);class o{static newEntity(e,t,i){let o=null;return o=t.collectionItem?new r.Entity(e,t.entity,i,t.collectionItem):new r.Entity(e,t.entity,i),o.deserialize(t),new Proxy(o,new s.EntityHandler)}static buildEntitySchemaFromData(e,t){const i={};i.entity=e.getName(),i.properties={},i.ref=e.isReferenced();for(let r in t)!0===e.isCollection()?(i.collectionItem=e.getItem(),e.getItemPrototype()&&(i.properties[r]=o.buildEntitySchemaFromData(e.getItemPrototype(),t[r]))):!0===e.getProperties()[r].isEntity?i.properties[r]=o.buildEntitySchemaFromData(e.getProperties()[r].value,t[r]):i.properties[r]={value:t[r]};return i}static buildEntityDataFromSchema(e){const t={};for(let i in e.properties)e.properties[i].entity?t[i]=o.buildEntityDataFromSchema(e.properties[i]):t[i]=e.properties[i].value;return t}}t.EntityFactory=o},557:(e,t)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.EntityHandler=void 0,t.EntityHandler=class{get(e,t,i){return e.getProperties()[t]?e.getProperties()[t].value:e[t]}set(e,t,i){return e.getProperties()[t]?(e.getProperties()[t].value=i,e.getEntityStore().update(e),!0):(e[t]=i,!0)}}},92:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.EntityProperty=void 0;const r=i(608);t.EntityProperty=class{constructor(e,t){this._isEntity=!1,this._entityStore=e,this._ref=t}get isEntity(){return this._isEntity}get value(){return this._value}set value(e){this._value=e}serialize(){return!0===this._isEntity?this._value.serialize():{value:this._value}}deserialize(e){if(e.entity){const t=!0===e.ref?this._ref:void 0;return this._value=r.EntityFactory.newEntity(this._entityStore,e,t),this._isEntity=!0,void this._value.deserialize(e)}this._value=e.value}}},758:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.EntityStore=void 0;const r=i(665),s=i(608),o=i(328),n=i(190),c=i(172),u=i(246);t.EntityStore=class{constructor(){this._sources={},this._entities={},this._actions={}}get actions(){return this._actions}addSource(e,t){this._sources[e]=t}register(e,t){this._entities[e.getKey()]=e,t?e.setSource(t):this._sources[e.getName()]?e.setSource(this._sources[e.getName()]):e.setSource(new n.NullSource)}sync(){for(;Object.keys(this._actions).length>0;){const e=Object.keys(this._actions)[0],t=this._actions[e];t.sync(t.entity.getSource()),delete this._actions[e]}}syncTo(e){return new Promise(((t,i)=>{const r={};for(const e in this._actions){const t=this._actions[e];t.sync(t.entity.getSource()),r[e]=c.SourceActionFactory.serialize(t)}e.send(r,(e=>{for(;Object.keys(this._actions).length>0;){const t=Object.keys(this._actions)[0],i=this._actions[t],r=i.entity.getName();e[r]&&(i.entity.deserialize(e[r]),this._sources[r]&&i.sync(this._sources[r])),delete this._actions[t]}t()}))}))}syncFrom(e,t,i){const r={},o={};for(const e in t){const i=t[e];this._entities[i.entityKey]||(this._entities[i.entityKey]=s.EntityFactory.newEntity(this,i.entity,this._entities[i.refKey]));const n=this._entities[i.entityKey];n.deserialize(i.entity),r[e]=c.SourceActionFactory.deserialize(i,n);const u=r[e].entity.getName();this._sources[u]&&(r[e].sync(this._sources[u]),o[u]=r[e].entity)}i(),this.sync();const n={};for(const e in o)n[e]=o[e].serialize();e.reply(n)}load(e){if(e.isReferenced()&&!e.isItem()&&e.getRef())return this.load(e.getRef());this._actions[e.getKey()+\"::load\"]=new o.LoadSourceAction(e)}update(e){if(e.isReferenced()&&!e.isItem()&&e.getRef())return this.update(e.getRef());this._actions[e.getKey()+\"::update\"]=new u.UpdateSourceAction(e)}delete(e){if(e.isReferenced()&&!e.isItem()&&e.getRef())return this.delete(e.getRef());this._actions[e.getKey()+\"::delete\"]=new r.DeleteSourceAction(e)}}},328:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.LoadSourceAction=void 0;const r=i(608),s=i(58);class o extends s.SourceAction{constructor(e){super(\"LoadSourceAction\",e)}sync(e){const t=this.entity.serialize(),i=r.EntityFactory.buildEntityDataFromSchema(t),s=e.load(i);this.validateLoad(s);const o=r.EntityFactory.buildEntitySchemaFromData(this.entity,s);this.entity.deserialize(o)}}t.LoadSourceAction=o},190:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.NullSource=void 0;const r=i(886);class s extends r.Source{load(e){return e}update(e){return e}delete(e){}}t.NullSource=s},625:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.NullSourceAction=void 0;const r=i(58);class s extends r.SourceAction{constructor(e){super(\"NullSourceAction\",e)}sync(e){throw new Error(\"NullSourceAction: method not implemented.\")}}t.NullSourceAction=s},886:(e,t)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.Source=void 0,t.Source=class{}},58:(e,t)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.SourceAction=void 0,t.SourceAction=class{constructor(e,t){this._type=e,this._entity=t}get type(){return this._type}get entity(){return this._entity}set entity(e){this._entity=e}validateLoad(e){}validateUpdate(e){}validateDelete(e){}}},172:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.SourceActionFactory=void 0;const r=i(665),s=i(328),o=i(625),n=i(246);t.SourceActionFactory=class{static serialize(e){const t={};return t.type=e.type,t.entityKey=e.entity.getKey(),t.entityType=e.entity.getName(),t.entity=e.entity.serialize(),t.refKey=e.entity.getRef()?e.entity.getRef().getKey():void 0,t}static deserialize(e,t){switch(e.type){case\"LoadSourceAction\":return new s.LoadSourceAction(t);case\"UpdateSourceAction\":return new n.UpdateSourceAction(t);case\"DeleteSourceAction\":return new r.DeleteSourceAction(t)}return new o.NullSourceAction(t)}}},246:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.UpdateSourceAction=void 0;const r=i(608),s=i(58);class o extends s.SourceAction{constructor(e){super(\"UpdateSourceAction\",e)}sync(e){const t=this.entity.serialize(),i=r.EntityFactory.buildEntityDataFromSchema(t);this.validateUpdate(i);const s=e.update(i),o=r.EntityFactory.buildEntitySchemaFromData(this.entity,s);this.entity.deserialize(o)}}t.UpdateSourceAction=o}},t={};function i(r){var s=t[r];if(void 0!==s)return s.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,i),o.exports}var r={};return(()=>{var e=r;Object.defineProperty(e,\"__esModule\",{value:!0}),e.Bridge=e.Source=e.EntityFactory=e.EntityStore=void 0;const t=i(758);Object.defineProperty(e,\"EntityStore\",{enumerable:!0,get:function(){return t.EntityStore}});const s=i(608);Object.defineProperty(e,\"EntityFactory\",{enumerable:!0,get:function(){return s.EntityFactory}});const o=i(886);Object.defineProperty(e,\"Source\",{enumerable:!0,get:function(){return o.Source}});const n=i(534);Object.defineProperty(e,\"Bridge\",{enumerable:!0,get:function(){return n.Bridge}})})(),r})()}));\n//# sourceMappingURL=entitystore.js.map","import { Influencer } from \"./influencer\";\nimport { NullState } from \"./nullstate\";\nimport { State } from \"./state\";\n\nexport class Follower {\n    private _name: string;\n    private _state: State = new NullState();\n    private _influencers: Influencer[] = [];\n    private _states: any = {};\n    private _trendStates: any = {};\n\n\n    public constructor(name: string) {\n        this._name = name;\n    }\n\n    public get name() {\n        return this._name;\n    }\n    \n    public addInfluencer(influencer: Influencer) {\n        this._influencers.push(influencer);\n    }\n\n    public addState(stateName: string, state: State) {\n        state.name = stateName;\n\n        this._states[stateName] = state;\n    }\n\n    public subscribe(influencer: Influencer) {\n        this.addInfluencer(influencer);\n\n        influencer.subscribe(this);\n    }\n\n    public follow(trend: string) {\n        this._influencers.forEach((influencer: Influencer) => {\n            influencer.follow(trend, this._name);\n        });\n    }\n\n    public on(trend: string, state: string) {\n        this._trendStates[trend] = this._states[state];\n    }\n\n    public changeState(state: string) {\n        this._state = this._states[state];\n    }\n\n    public handle(trend: string, model: any): void {\n        this._state.handle(this, trend, model);\n    }\n\n    public onTrendChange(trend: string, model: any): void {\n        if(this._trendStates[trend]) {\n            this._state = this._trendStates[trend];\n        }\n        \n        this.handle(trend, model);\n    }\n\n    public set state(state: State) {\n        this._state = state;\n    }\n\n    public serialize(): any {\n        return {\n            name: this._name,\n            state: this._state.name\n        }\n    }\n\n    public deserialize(follower: any) {\n        this._name = follower.name;\n        this._state = this._states[follower.state];\n    }\n}","import { Follower } from \"./follower\";\n\nexport class Influencer {\n    protected _followers: any = {};\n    protected _trends: any = {};\n\n\n    public subscribe(follower: Follower){\n        this._followers[follower.name] = follower;\n    }\n\n    public init(trends: any) {\n        for(const key in trends) {\n            const followers = trends[key];\n\n            for(let i=0; i<followers.length; i++) {\n                if(this._followers[followers[i].name]) {\n                    const follower = this._followers[followers[i].name];\n\n                    follower.deserialize(followers[i]);\n                }\n            }\n        }\n    }\n\n    public follow(trend: string, follower: string) {\n        if(!this._trends[trend]) {\n            this._trends[trend] = [];\n        }\n        \n        this._trends[trend].push(this._followers[follower]);\n    }\n\n    public newTrend(trend: string, model: any) {\n        const followers = this._trends[trend];\n\n        if(!followers) {\n            return;\n        }\n\n        for(let i=0; i<followers.length; i++) {\n            followers[i].onTrendChange(trend, model);\n        }\n    }\n\n    public serialize(): any {\n        const influencer: any = {\n            followers: {}\n        };\n\n        for(const key in this._followers) {\n            const follower = this._followers[key];\n            \n            influencer.followers[key] = follower.serialize();\n        }\n\n        return influencer;\n    }\n}","import { Follower } from \"./follower\";\nimport { State } from \"./state\";\n\nexport class NullState extends State {\n    public handle(follower: Follower, trend: string, model: any): void {\n        \n    }\n}","import { Follower } from \"./follower\";\n\nexport abstract class State {\n    private _name: string = \"\";\n\n\n    public set name(name: string) {\n        this._name = name;\n    }\n\n    public get name() {\n        return this._name;\n    }\n\n    public abstract handle(follower: Follower, trend: string, model: any): void;\n}","import { Influencer } from \"./influencer/influencer\";\nimport { EntityStore } from \"js-entity-store\"\nimport { EntityFactory } from \"js-entity-store\";\nimport { Source } from \"js-entity-store\";\nimport { Bridge } from \"js-entity-store\";\nimport { SinglefinSource } from \"./singlefinsource\";\nimport { ModelLoader } from \"./modelloader\";\n\n\nexport class Singlefin extends Influencer {\n    private _entityStore: EntityStore = new EntityStore();\n    private _model: any;\n    private _currentTrend: any;\n\n    public constructor() {\n        super();\n\n        this._currentTrend = EntityFactory.newEntity(this._entityStore, {\n            \"entity\": \"Singlefin\",\n            \"ref\": false,\n            \"properties\": {\n                \"trend\": {\n                    \"value\": \"\"\n                },\n                \"trends\": {\n                    \"value\": {}\n                }\n            }\n        });\n\n        this._entityStore.addSource(\"Singlefin\", new SinglefinSource());\n    }\n\n    public loadModel(modelLoader: ModelLoader) {\n        return new Promise<void>((resolve, reject) => {\n            modelLoader.load((model: any) => {\n                this._model = EntityFactory.newEntity(this._entityStore, model);\n\n                resolve();\n            });\n        });\n    }\n\n    public setModel(model: any) {\n        this._model = EntityFactory.newEntity(this._entityStore, model);\n    }\n\n    public get model(): any {\n        return this._model;\n    }\n\n    public addSource(entityName: string, source: Source) {\n        this._entityStore.addSource(entityName, source);\n    }\n\n    public inform(trend: string) {\n        const followers = this._trends[trend];\n\n        this._currentTrend.trend = trend;\n        this._currentTrend.trends[trend] = this.serializeFollowers(followers);\n\n        this._entityStore.sync();\n\n        this.newTrend(trend, this._model);\n\n        this._entityStore.sync();\n    }\n\n    public informTo(bridge: Bridge, trend: string) {\n        const followers = this._trends[trend];\n\n        this._currentTrend.trend = trend;\n        this._currentTrend.trends[trend] = this.serializeFollowers(followers);\n\n        return this._entityStore.syncTo(bridge).then(() => {\n            this.init(this._currentTrend.trends);\n\n            this.newTrend(this._currentTrend.trend, this._model);\n\n            return this._entityStore.syncTo(bridge);\n        });\n    }\n\n    public informFrom(bridge: Bridge, actions: any) {\n        this._entityStore.syncFrom(bridge, actions, () => {\n            this.init(this._currentTrend.trends);\n\n            this.newTrend(this._currentTrend.trend, this._model);\n\n            const followers = this._trends[this._currentTrend.trend];\n\n            this._currentTrend.trends[this._currentTrend.trend] = this.serializeFollowers(followers);\n        });\n    }\n\n    private serializeFollowers(followers: any[]) {\n        const serializedFollowers = [];\n\n        for(let i=0; i<followers.length; i++) {\n            serializedFollowers.push(followers[i].serialize());\n        }\n\n        return serializedFollowers;\n    }\n}\n","import { Source } from \"js-entity-store\";\n\nexport class SinglefinSource extends Source {\n    public load(entity: any) {\n        return entity;\n    }\n    public update(entity: any) {\n        return entity;\n    }\n    public delete(entity: any): void {\n    }\n    \n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import { Singlefin } from \"./singlefin\";\nimport { Follower } from \"./influencer/follower\";\nimport { ModelLoader } from \"./modelloader\";\nimport { State } from \"./influencer/state\";\nimport { Bridge } from \"js-entity-store\";\n\n\nexport { Singlefin, Follower, ModelLoader, State, Bridge }"],"names":[],"sourceRoot":""}